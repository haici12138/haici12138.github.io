import{d as s,g as e,m as a,A as l,p as t,o as d,j as u,b as r,w as o,a as c,u as n,c as i,e as p,t as m,F as f,r as v,y as _,n as y,B as g,Z as x,h as b,f as k,k as I,U as h,I as P,v as j,i as w}from"./index-1160dd25.js";import{o as A}from"./index.0a89d6f4.js";import{U as F}from"./address.b1290e47.js";import{_ as M}from"./_plugin-vue_export-helper.1b428a4d.js";import"./http.22d6ec59.js";const T=M(s({__name:"create",props:{skuId:null,count:null,addressId:null},setup(s){const M=s,{safeAreaInsets:T}=e(),C=a(""),O=a([{type:1,text:"时间不限 (周一至周日)"},{type:2,text:"工作日送 (周一至周五)"},{type:3,text:"周末配送 (周六至周日)"}]),U=a(0),V=l((()=>O.value[U.value])),B=s=>{U.value=s.detail.value},G=a();t((()=>{M.count&&M.skuId?L():(async()=>{const s=await A.GetPerOrder();G.value=s.result})()}));const $=F(),D=l((()=>{var s;return $.selectedAddress||(null==(s=G.value)?void 0:s.userAddresses.find((s=>1==s.isDefault)))})),L=async()=>{const s=await A.GoPerNow({skuId:M.skuId,count:M.count,addressId:M.addressId});G.value=s.result},N=async()=>{var s,e;if(!(null==(s=D.value)?void 0:s.id))return g({icon:"none",title:"请选择收货地址"});const a=await A.postMemberOrderAPI({addressId:null==(e=D.value)?void 0:e.id,buyerMessage:C.value,deliveryTimeType:V.value.type,goods:G.value.goods.map((s=>({count:s.count,skuId:s.skuId}))),payChannel:2,payType:1});x({url:`/pagesOrder/detail/detail?id=${a.result.id}`})};return(s,e)=>{var a;const l=b,t=k,g=I,x=w,A=h,F=P,M=j;return d(),u(f,null,[r(M,{"scroll-y":"",class:"viewport"},{default:o((()=>[c(" 收货地址 "),n(D)?(d(),i(g,{key:0,class:"shipment","hover-class":"none",url:"/pagesMember/address/address?from=order"},{default:o((()=>[r(l,{class:"user"},{default:o((()=>[p(m(n(D).receiver)+" "+m(n(D).contact),1)])),_:1}),r(l,{class:"address"},{default:o((()=>[p(m(n(D).fullLocation)+" "+m(n(D).address),1)])),_:1}),r(t,{class:"icon icon-right"})])),_:1})):(d(),i(g,{key:1,class:"shipment","hover-class":"none",url:"/pagesMember/address/address?from=order"},{default:o((()=>[r(l,{class:"address"},{default:o((()=>[p(" 请选择收货地址 ")])),_:1}),r(t,{class:"icon icon-right"})])),_:1})),c(" 商品信息 "),r(l,{class:"goods"},{default:o((()=>{var s;return[(d(!0),u(f,null,v(null==(s=G.value)?void 0:s.goods,(s=>(d(),i(g,{key:s.skuId,url:`/pages/goods/goods?id=${s.id}`,class:"item","hover-class":"none"},{default:o((()=>[r(x,{class:"picture",src:s.picture},null,8,["src"]),r(l,{class:"meta"},{default:o((()=>[r(l,{class:"name ellipsis"},{default:o((()=>[p(m(s.name),1)])),_:2},1024),r(l,{class:"attrs"},{default:o((()=>[p(m(s.attrsText),1)])),_:2},1024),r(l,{class:"prices"},{default:o((()=>[r(l,{class:"pay-price symbol"},{default:o((()=>[p(m(s.payPrice),1)])),_:2},1024),r(l,{class:"price symbol"},{default:o((()=>[p(m(s.price),1)])),_:2},1024)])),_:2},1024),r(l,{class:"count"},{default:o((()=>[p("x"+m(s.count),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["url"])))),128))]})),_:1}),c(" 配送及支付方式 "),r(l,{class:"related"},{default:o((()=>[r(l,{class:"item"},{default:o((()=>[r(t,{class:"text"},{default:o((()=>[p("配送时间")])),_:1}),r(A,{range:O.value,"range-key":"text",onChange:B},{default:o((()=>[r(l,{class:"icon-fonts picker"},{default:o((()=>[p(m(n(V).text),1)])),_:1})])),_:1},8,["range"])])),_:1}),r(l,{class:"item"},{default:o((()=>[r(t,{class:"text"},{default:o((()=>[p("订单备注")])),_:1}),r(F,{class:"input","cursor-spacing":30,placeholder:"选题，建议留言前先与商家沟通确认",modelValue:C.value,"onUpdate:modelValue":e[0]||(e[0]=s=>C.value=s)},null,8,["modelValue"])])),_:1})])),_:1}),c(" 支付金额 "),r(l,{class:"settlement"},{default:o((()=>[r(l,{class:"item"},{default:o((()=>[r(t,{class:"text"},{default:o((()=>[p("商品总价: ")])),_:1}),r(t,{class:"number symbol"},{default:o((()=>{var s;return[p(m(null==(s=G.value)?void 0:s.summary.totalPrice.toFixed(2)),1)]})),_:1})])),_:1}),r(l,{class:"item"},{default:o((()=>[r(t,{class:"text"},{default:o((()=>[p("运费: ")])),_:1}),r(t,{class:"number symbol"},{default:o((()=>{var s;return[p(m(null==(s=G.value)?void 0:s.summary.postFee.toFixed(2)),1)]})),_:1})])),_:1})])),_:1})])),_:1}),c(" 吸底工具栏 "),r(l,{class:"toolbar",style:y({paddingBottom:(null==(a=n(T))?void 0:a.bottom)+"px"})},{default:o((()=>{var s;return[r(l,{class:"total-pay symbol"},{default:o((()=>[r(t,{class:"number"},{default:o((()=>{var s;return[p(m(null==(s=G.value)?void 0:s.summary.totalPayPrice.toFixed(2)),1)]})),_:1})])),_:1}),r(l,{class:_(["button",{disabled:!(null==(s=n(D))?void 0:s.id)}]),onClick:N},{default:o((()=>[p(" 提交订单 ")])),_:1},8,["class"])]})),_:1},8,["style"])],64)}}}),[["__scopeId","data-v-1738ccd6"]]);export{T as default};
