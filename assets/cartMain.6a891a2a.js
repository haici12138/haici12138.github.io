import{d as e,x as a,m as s,z as l,A as t,o as c,c as u,w as n,a as o,u as i,j as d,b as r,e as f,F as _,r as p,y as m,t as k,B as v,C as g,f as b,h as x,i as h,k as w,q as y,s as C,D as j,v as I,E as V}from"./index-d94b4424.js";import{_ as D}from"./vk-data-input-number-box.ed9d2100.js";import{_ as F,a as T}from"./uni-swipe-action.5fb5d358.js";import{_ as q}from"./XtxGuess.d8e580d8.js";import{u as A}from"./index.066190b7.js";import{_ as E}from"./_plugin-vue_export-helper.1b428a4d.js";const G=E(e({__name:"cartMain",setup(e){const E=a(),G=s([]),P=async()=>{const e=await A.getCart();G.value=e.result};l((()=>{E.profile&&P()}));const U=async e=>{await A.editCart(e.index,{count:e.value})};t((()=>{console.log(G.value.find((e=>e.selected)),"isDisabled")}));const X=t((()=>G.value.length&&G.value.every((e=>e.selected)))),z=async()=>{const e=!X.value;G.value.forEach((a=>a.selected=e)),await A.editSelectAllCart({selected:e})},B=t((()=>G.value.filter((e=>e.selected))||[])),M=t((()=>B.value.reduce(((e,a)=>e+a.count),0))),O=t((()=>B.value.reduce(((e,a)=>e+a.nowPrice*a.count),0).toFixed(2))),R=()=>{if(0==M.value)return v({icon:"none",title:"请选择商品"});g({url:"/pagesOrder/create/create"})};return(e,a)=>{const s=b,l=x,t=h,g=w,B=y(C("vk-data-input-number-box"),D),S=j,$=y(C("uni-swipe-action-item"),F),H=y(C("uni-swipe-action"),T),J=y(C("XtxGuess"),q),K=I;return c(),u(K,{"scroll-y":"",class:"scroll-view"},{default:n((()=>[o(" 已登录: 显示购物车 "),i(E).profile?(c(),d(_,{key:0},[o(" 购物车列表 "),G.value.length>0?(c(),u(l,{key:0,class:"cart-list"},{default:n((()=>[o(" 优惠提示 "),r(l,{class:"tips"},{default:n((()=>[r(s,{class:"label"},{default:n((()=>[f("满减")])),_:1}),r(s,{class:"desc"},{default:n((()=>[f("满1件, 即可享受9折优惠")])),_:1})])),_:1}),o(" 滑动操作分区 "),r(H,null,{default:n((()=>[o(" 滑动操作项 "),(c(!0),d(_,null,p(G.value,(e=>(c(),u($,{key:e.skuId,class:"cart-swipe"},{right:n((()=>[r(l,{class:"cart-swipe-right",onClick:a=>{return s=e.skuId,void V({content:"确认删除该商品吗？",success:async e=>{e.confirm&&(await A.DelCart({ids:[s]}),v({title:"删除成功",icon:"none"}),P())}});var s}},{default:n((()=>[r(S,{class:"button delete-button"},{default:n((()=>[f("删除")])),_:1})])),_:2},1032,["onClick"])])),default:n((()=>[r(l,{class:"goods"},{default:n((()=>[o(" 选中状态 "),r(s,{class:m(["checkbox",{checked:e.selected}]),onClick:a=>(async e=>{e.selected=!e.selected,await A.editCart(e.skuId,{selected:e.selected})})(e)},null,8,["class","onClick"]),r(g,{url:`/pages/goods/goods?id=${e.id}`,"hover-class":"none",class:"navigator"},{default:n((()=>[r(t,{mode:"aspectFill",class:"picture",src:e.picture},null,8,["src"]),r(l,{class:"meta"},{default:n((()=>[r(l,{class:"name ellipsis"},{default:n((()=>[f(k(e.name),1)])),_:2},1024),r(l,{class:"attrsText ellipsis"},{default:n((()=>[f(k(e.attrsText),1)])),_:2},1024),r(l,{class:"price"},{default:n((()=>[f(k(e.nowPrice),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["url"]),o(" 商品数量 "),r(l,{class:"count"},{default:n((()=>[r(B,{modelValue:e.count,"onUpdate:modelValue":a=>e.count=a,min:1,max:e.stock,index:e.skuId,onChange:U},null,8,["modelValue","onUpdate:modelValue","max","index"])])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1})):(c(),d(_,{key:1},[o(" 购物车空状态 "),r(l,{class:"cart-blank"},{default:n((()=>[r(t,{src:"./static/images/blank_cart.png",class:"image"}),r(s,{class:"text"},{default:n((()=>[f("购物车还是空的，快来挑选好货吧")])),_:1}),r(g,{"open-type":"switchTab",url:"/pages/index/index","hover-class":"none"},{default:n((()=>[r(S,{class:"button"},{default:n((()=>[f("去首页看看")])),_:1})])),_:1})])),_:1})],2112)),o(" 吸底工具栏 "),r(l,{class:"toolbar"},{default:n((()=>[r(s,{class:m(["all",{checked:i(X)}]),onClick:z},{default:n((()=>[f("全选")])),_:1},8,["class"]),r(s,{class:"text"},{default:n((()=>[f("合计:")])),_:1}),r(s,{class:"amount"},{default:n((()=>[f(k(i(O)),1)])),_:1}),r(l,{class:"button-grounp",onClick:R},{default:n((()=>[r(l,{class:m(["button payment-button",{disabled:0==i(M)}])},{default:n((()=>[f(" 去结算("+k(i(M))+") ",1)])),_:1},8,["class"])])),_:1})])),_:1})],64)):(c(),d(_,{key:1},[o(" 未登录: 提示登录 "),r(l,{class:"login-blank"},{default:n((()=>[r(s,{class:"text"},{default:n((()=>[f("登录后可查看购物车中的商品")])),_:1}),r(g,{url:"/pages/login/login","hover-class":"none"},{default:n((()=>[r(S,{class:"button"},{default:n((()=>[f("去登录")])),_:1})])),_:1})])),_:1})],2112)),o(" 猜你喜欢 "),r(J,{ref:"guessRef"},null,512),o(" 底部占位空盒子 "),r(l,{class:"toolbar-height"})])),_:1})}}}),[["__scopeId","data-v-6b1cdc6c"]]);export{G as C};
