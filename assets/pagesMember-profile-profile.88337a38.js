import{d as a,g as e,x as l,m as s,p as t,o as u,c as o,w as r,a as n,b as c,e as d,n as i,u as v,t as f,B as m,G as p,P as _,k as h,h as k,i as b,f as y,I as g,Q as x,R as C,T as V,U as j,D as w}from"./index-1160dd25.js";import{u as I}from"./index.bc1a2cbc.js";import{_ as U}from"./_plugin-vue_export-helper.1b428a4d.js";import"./http.22d6ec59.js";const L=U(a({__name:"profile",setup(a){const{safeAreaInsets:U}=e(),L=l(),T=s({}),F=async()=>{const{nickname:a,gender:e,birthday:l,profession:s}=T.value,t=await I.editUserInfo({nickname:a,gender:e,birthday:l,profession:s,provinceCode:A[0],cityCode:A[1],countyCode:A[2]});L.profile.nickname=t.result.nickname,m({icon:"success",title:"保存成功"}),setTimeout((()=>{p()}),500)},P=()=>{uni.chooseMedia({count:1,mediaType:["image"],success:a=>{console.log(a);const{tempFilePath:e}=a.tempFiles[0];_({url:"/member/profile/avatar",name:"file",filePath:e,success:a=>{200===a.statusCode?(T.value.avatar=JSON.parse(a.data).result.avatar,L.profile.avatar=T.value.avatar,m({title:"上传成功",icon:"success"})):m({title:"上传失败",icon:"error"}),console.log(a)}})}})},B=a=>{T.value.gender=a.detail.value},D=a=>{T.value.birthday=a.detail.value};var A=["","",""];const G=a=>{A=a.detail.code,T.value.fullLocation=a.detail.value.join(" ")};return t((()=>{(async()=>{const a=await I.getUserInfo();T.value=a.result})()})),(a,e)=>{const l=h,s=k,t=b,m=y,p=g,_=x,I=C,L=V,A=j,J=w;return u(),o(s,{class:"viewport"},{default:r((()=>{var a;return[n(" 导航栏 "),c(s,{class:"navbar",style:i({paddingTop:(null==(a=v(U))?void 0:a.top)+"px"})},{default:r((()=>[c(l,{"open-type":"navigateBack",class:"back icon-left","hover-class":"none"}),c(s,{class:"title"},{default:r((()=>[d("个人信息")])),_:1})])),_:1},8,["style"]),n(" 头像 "),c(s,{class:"avatar"},{default:r((()=>[c(s,{class:"avatar-content",onClick:P},{default:r((()=>{var a;return[c(t,{class:"image",src:null==(a=T.value)?void 0:a.avatar,mode:"aspectFill"},null,8,["src"]),c(m,{class:"text"},{default:r((()=>[d("点击修改头像")])),_:1})]})),_:1})])),_:1}),n(" 表单 "),c(s,{class:"form"},{default:r((()=>[n(" 表单内容 "),c(s,{class:"form-content"},{default:r((()=>[c(s,{class:"form-item"},{default:r((()=>[c(m,{class:"label"},{default:r((()=>[d("账号")])),_:1}),c(m,{class:"account"},{default:r((()=>{var a;return[d(f(null==(a=T.value)?void 0:a.account),1)]})),_:1})])),_:1}),c(s,{class:"form-item"},{default:r((()=>[c(m,{class:"label"},{default:r((()=>[d("昵称")])),_:1}),c(p,{class:"input",type:"text",placeholder:"请填写昵称",modelValue:T.value.nickname,"onUpdate:modelValue":e[0]||(e[0]=a=>T.value.nickname=a)},null,8,["modelValue"])])),_:1}),c(s,{class:"form-item"},{default:r((()=>[c(m,{class:"label"},{default:r((()=>[d("性别")])),_:1}),c(L,{onChange:B},{default:r((()=>[c(I,{class:"radio"},{default:r((()=>{var a;return[c(_,{value:"男",color:"#27ba9b",checked:"男"==(null==(a=T.value)?void 0:a.gender)},null,8,["checked"]),d(" 男 ")]})),_:1}),c(I,{class:"radio"},{default:r((()=>{var a;return[c(_,{value:"女",color:"#27ba9b",checked:"女"==(null==(a=T.value)?void 0:a.gender)},null,8,["checked"]),d(" 女 ")]})),_:1})])),_:1})])),_:1}),c(s,{class:"form-item"},{default:r((()=>{var a;return[c(m,{class:"label"},{default:r((()=>[d("生日")])),_:1}),c(A,{class:"picker",onChange:D,mode:"date",start:"1900-01-01",end:new Date,value:null==(a=T.value)?void 0:a.birthday},{default:r((()=>{var a;return[(null==(a=T.value)?void 0:a.birthday)?(u(),o(s,{key:0},{default:r((()=>{var a;return[d(f(null==(a=T.value)?void 0:a.birthday),1)]})),_:1})):(u(),o(s,{key:1,class:"placeholder"},{default:r((()=>[d("请选择日期")])),_:1}))]})),_:1},8,["end","value"])]})),_:1}),c(s,{class:"form-item"},{default:r((()=>{var a,e;return[c(m,{class:"label"},{default:r((()=>[d("城市")])),_:1}),c(A,{onChange:G,class:"picker",mode:"region",value:null==(e=null==(a=T.value)?void 0:a.fullLocation)?void 0:e.split(" ")},{default:r((()=>{var a;return[(null==(a=T.value)?void 0:a.fullLocation)?(u(),o(s,{key:0},{default:r((()=>{var a;return[d(f(null==(a=T.value)?void 0:a.fullLocation),1)]})),_:1})):(u(),o(s,{key:1,class:"placeholder"},{default:r((()=>[d("请选择城市")])),_:1}))]})),_:1},8,["value"])]})),_:1}),c(s,{class:"form-item"},{default:r((()=>[c(m,{class:"label"},{default:r((()=>[d("职业")])),_:1}),c(p,{class:"input",type:"text",placeholder:"请填写职业",modelValue:T.value.profession,"onUpdate:modelValue":e[1]||(e[1]=a=>T.value.profession=a)},null,8,["modelValue"])])),_:1})])),_:1}),n(" 提交按钮 "),c(J,{class:"form-button",onClick:F},{default:r((()=>[d("保 存")])),_:1})])),_:1})]})),_:1})}}}),[["__scopeId","data-v-6ff8ed2a"]]);export{L as default};
